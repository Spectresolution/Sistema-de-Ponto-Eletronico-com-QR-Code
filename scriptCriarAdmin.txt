cd ~/Documentos/Sistema_de_Ponto_Eletronico/backend

# 1. Apague o banco se quiser comeÃ§ar do zero
rm -f ponto_eletronico.db

# 2. Crie apenas as tabelas (sem admin)
node -e "
const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('ponto_eletronico.db');

db.serialize(() => {
  // Tabela funcionario
  db.run(\`
    CREATE TABLE funcionario (
      id INTEGER PRIMARY KEY AUTOINCREMENT,
      nome TEXT NOT NULL,
      cpf TEXT UNIQUE NOT NULL,
      email TEXT UNIQUE NOT NULL,
      senha_hash TEXT NOT NULL,
      cargo TEXT NOT NULL,
      data_contratacao TEXT NOT NULL,
      is_admin BOOLEAN DEFAULT 0,
      ativo BOOLEAN DEFAULT 1
    )
  \`);
  
  console.log('âœ… Tabela funcionario criada');
});

db.close();
"

# 3. Crie o admin via SQL direto (senha: admin123)
node -e "
const bcrypt = require('bcryptjs');
const sqlite3 = require('sqlite3').verbose();
const db = new sqlite3.Database('ponto_eletronico.db');

bcrypt.hash('admin123', 10).then(hash => {
  db.run(
    \`INSERT INTO funcionario 
    (nome, email, senha_hash, cpf, cargo, data_contratacao, is_admin) 
    VALUES (?, ?, ?, ?, ?, date('now'), 1)\`,
    ['Administrador', 'admin@email.com', hash, '000.000.001-00', 'Administrador'],
    function(err) {
      if (err) console.error('Erro:', err);
      else console.log('âœ… Admin criado! ID:', this.lastID);
      
      // Verifique
      db.all('SELECT * FROM funcionario', (err, rows) => {
        console.log('\\nðŸ“‹ FuncionÃ¡rios no banco:');
        rows.forEach(r => console.log(\`- \${r.id}: \${r.nome} (\${r.email}) - Admin: \${r.is_admin}\`));
        db.close();
      });
    }
  );
});
"

#Depois para descobrir a hash dele
sqlite3 ponto_eletronico.db "SELECT senha_hash FROM funcionario WHERE email = 'admin@email.com';"